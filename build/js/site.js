function IconSelect(e,o){function t(){if(o||(o={}),n.setIconSelectElement(e)){o=l.checkParameters(o);{n.createUI(o,e)}n.iconSelectElement.onclick=function(){n.showBox()},n.showBox(!1),n.iconSelectElement.addEventListener("click",function(e){e.stopPropagation()}),window.addEventListener("click",function(){n.showBox(!1)})}else alert("Element not found.")}function n(){}function l(){}var r,i=[],s=-1,a=IconSelect.DEFAULT;this.refresh=function(e){i=[];for(var t=this.setSelectedIndex,l=0;l<e.length;l++)e[l].element=n.createIcon(e[l].iconFilePath,e[l].iconValue,l,o),e[l].element.onclick=function(){t(this.childNodes[0].getAttribute("icon-index"))},i.push(e[l]);var r=10;n.boxElement.style.height=(o.iconsHeight+2)*r+(r+1)*o.boxIconSpace,this.setSelectedIndex(0)},this.getIcons=function(){return i},this.setSelectedIndex=function(e){var o;i.length>e&&(o=i[e]),o&&(-1!=s&&i[s].element.setAttribute("class","icon"),s=e,n.selectedIconImgElement.setAttribute("src",o.iconFilePath),-1!=s&&i[s].element.setAttribute("class","icon selected")),n.iconSelectElement.dispatchEvent(new Event("changed"))},this.getSelectedIndex=function(){return s},this.getSelectedValue=function(){return i[s].iconValue},this.getSelectedFilePath=function(){return i[s].iconFilePath},n.iconSelectElement,n.boxElement,n.boxScrollElement,n.selectedIconImgElement,n.selectedIconElement,n.showBox=function(o){null==o&&(o="none"==n.boxElement.style.display?!0:!1),o?(n.boxElement.style.display="block",n.boxScrollElement.style.display="block",r=r?r:new iScroll(e+"-box-scroll")):(n.boxElement.style.display="none",n.boxScrollElement.style.display="none"),n.boxElement.style.display=o?"block":"none"},n.setIconSelectElement=function(e){return n.iconSelectElement=document.getElementById(e),n.iconSelectElement},n.clearUI=function(){n.iconSelectElement.innerHTML=""},n.clearIcons=function(){n.boxElement.innerHTML=""},n.createUI=function(o){n.clearUI(),n.iconSelectElement.setAttribute("class","icon-select");var t=document.createElement("div");t.setAttribute("class","selected-box");var l=document.createElement("div");l.setAttribute("class","selected-icon"),n.selectedIconImgElement=document.createElement("img"),n.selectedIconImgElement.setAttribute("src",""),l.appendChild(n.selectedIconImgElement);var r=document.createElement("div");r.setAttribute("class","component-icon");var i=document.createElement("img");i.setAttribute("src",IconSelect.COMPONENT_ICON_FILE_PATH),r.appendChild(i),n.boxScrollElement=document.createElement("div"),n.boxScrollElement.setAttribute("id",e+"-box-scroll"),n.boxScrollElement.setAttribute("class","box"),n.boxElement=document.createElement("div"),n.boxScrollElement.appendChild(n.boxElement),n.selectedIconImgElement.setAttribute("width",o.selectedIconWidth),n.selectedIconImgElement.setAttribute("height",o.selectedIconHeight),l.style.width=o.selectedIconWidth,l.style.height=o.selectedIconHeight,t.style.width=o.selectedIconWidth+o.selectedBoxPadding+o.selectedBoxPaddingRight,t.style.height=o.selectedIconHeight+2*o.selectedBoxPadding,l.style.top=o.selectedBoxPadding,l.style.left=o.selectedBoxPadding,r.style.bottom=4+o.selectedBoxPadding,n.boxScrollElement.style.left=parseInt(t.style.width)+1,n.boxScrollElement.style.width=(o.iconsWidth+2)*o.vectoralIconNumber+(o.vectoralIconNumber+1)*o.boxIconSpace,n.boxScrollElement.style.height=(o.iconsHeight+2)*o.horizontalIconNumber+(o.horizontalIconNumber+1)*o.boxIconSpace,n.boxElement.style.left=n.boxScrollElement.style.left,n.boxElement.style.width=n.boxScrollElement.style.width,n.iconSelectElement.appendChild(t),t.appendChild(l),t.appendChild(r),t.appendChild(n.boxScrollElement);var s={};return s.iconSelectElement=n.iconSelectElement,s.selectedBoxElement=t,s.selectedIconElement=l,s.selectedIconImgElement=n.selectedIconImgElement,s.componentIconElement=r,s.componentIconImgElement=i,s},n.createIcon=function(e,o,t,l){var r=document.createElement("div");r.setAttribute("class","icon"),r.style.width=l.iconsWidth,r.style.height=l.iconsHeight,r.style.marginLeft=l.boxIconSpace,r.style.marginTop=l.boxIconSpace;var i=document.createElement("img");return i.setAttribute("src",e),i.setAttribute("icon-value",o),i.setAttribute("icon-index",t),i.setAttribute("width",l.iconsWidth),i.setAttribute("height",l.iconsHeight),r.appendChild(i),n.boxElement.appendChild(r),r},l.checkParameters=function(e){return e.selectedIconWidth=e.selectedIconWidth?e.selectedIconWidth:a.SELECTED_ICON_WIDTH,e.selectedIconHeight=e.selectedIconHeight?e.selectedIconHeight:a.SELECTED_ICON_HEIGHT,e.selectedBoxPadding=e.selectedBoxPadding?e.selectedBoxPadding:a.SELECTED_BOX_PADDING,e.selectedBoxPaddingRight=e.selectedBoxPaddingRight?e.selectedBoxPaddingRight:a.SELECTED_BOX_PADDING_RIGHT,e.iconsWidth=e.iconsWidth?e.iconsWidth:a.ICONS_WIDTH,e.iconsHeight=e.iconsHeight?e.iconsHeight:a.ICONS_HEIGHT,e.boxIconSpace=e.boxIconSpace?e.boxIconSpace:a.BOX_ICON_SPACE,e.vectoralIconNumber=e.vectoralIconNumber?e.vectoralIconNumber:a.VECTORAL_ICON_NUMBER,e.horizontalIconNumber=e.horizontalIconNumber?e.horizontalIconNumber:a.HORIZONTAL_ICON_NUMBER,e},t()}$(document).ready(function(){$("#tags").tagsInput({height:"60px",width:"280px"})}),IconSelect.DEFAULT={},IconSelect.DEFAULT.SELECTED_ICON_WIDTH=48,IconSelect.DEFAULT.SELECTED_ICON_HEIGHT=48,IconSelect.DEFAULT.SELECTED_BOX_PADDING=1,IconSelect.DEFAULT.SELECTED_BOX_PADDING_RIGHT=12,IconSelect.DEFAULT.ICONS_WIDTH=32,IconSelect.DEFAULT.ICONS_HEIGHT=32,IconSelect.DEFAULT.BOX_ICON_SPACE=1,IconSelect.DEFAULT.HORIZONTAL_ICON_NUMBER=3,IconSelect.DEFAULT.VECTORAL_ICON_NUMBER=3,IconSelect.COMPONENT_ICON_FILE_PATH="/img/arrow.png",window.onload=function(){var e,o=document.getElementById("cursor-id");if(o){var t=[],n=R.range(1,55);R.forEach(function(e){t.push({iconFilePath:"/img/cursors/"+e+".png",iconValue:e})})(n),e=new IconSelect("my-icon-select",{selectedIconWidth:48,selectedIconHeight:42,selectedBoxPadding:0,iconsWidth:48,iconsHeight:42,boxIconSpace:0,vectoralIconNumber:14,horizontalIconNumber:14}),e.refresh(t),e.setSelectedIndex(Number(o.value)-1),document.getElementById("my-icon-select").addEventListener("changed",function(){o.value=e.getSelectedValue()})}},function(e,o){function t(e){return""===r?e:(e=e.charAt(0).toUpperCase()+e.substr(1),r+e)}var n=Math,l=o.createElement("div").style,r=function(){for(var e,o="t,webkitT,MozT,msT,OT".split(","),t=0,n=o.length;n>t;t++)if(e=o[t]+"ransform",e in l)return o[t].substr(0,o[t].length-1);return!1}(),i=r?"-"+r.toLowerCase()+"-":"",s=t("transform"),a=t("transitionProperty"),c=t("transitionDuration"),p=t("transformOrigin"),m=t("transitionTimingFunction"),d=t("transitionDelay"),h=/android/gi.test(navigator.appVersion),u=/iphone|ipad/gi.test(navigator.appVersion),S=/hp-tablet/gi.test(navigator.appVersion),b=t("perspective")in l,x="ontouchstart"in e&&!S,g=r!==!1,f=t("transition")in l,E="onorientationchange"in e?"orientationchange":"resize",y=x?"touchstart":"mousedown",v=x?"touchmove":"mousemove",I=x?"touchend":"mouseup",T=x?"touchcancel":"mouseup",_=function(){if(r===!1)return!1;var e={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return e[r]}(),Y=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){return setTimeout(e,1)}}(),w=function(){return e.cancelRequestAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),X=b?" translateZ(0)":"",z=function(t,n){var l,r=this;r.wrapper="object"==typeof t?t:o.getElementById(t),r.wrapper.style.overflow="hidden",r.scroller=r.wrapper.children[0],r.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:h,hideScrollbar:u,fadeScrollbar:u&&b,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(l in n)r.options[l]=n[l];r.x=r.options.x,r.y=r.options.y,r.options.useTransform=g&&r.options.useTransform,r.options.hScrollbar=r.options.hScroll&&r.options.hScrollbar,r.options.vScrollbar=r.options.vScroll&&r.options.vScrollbar,r.options.zoom=r.options.useTransform&&r.options.zoom,r.options.useTransition=f&&r.options.useTransition,r.options.zoom&&h&&(X=""),r.scroller.style[a]=r.options.useTransform?i+"transform":"top left",r.scroller.style[c]="0",r.scroller.style[p]="0 0",r.options.useTransition&&(r.scroller.style[m]="cubic-bezier(0.33,0.66,0.66,1)"),r.options.useTransform?r.scroller.style[s]="translate("+r.x+"px,"+r.y+"px)"+X:r.scroller.style.cssText+=";position:absolute;top:"+r.y+"px;left:"+r.x+"px",r.options.useTransition&&(r.options.fixedScrollbar=!0),r.refresh(),r._bind(E,e),r._bind(y),x||"none"!=r.options.wheelAction&&(r._bind("DOMMouseScroll"),r._bind("mousewheel")),r.options.checkDOMChanges&&(r.checkDOMTime=setInterval(function(){r._checkDOMChanges()},500))};z.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var o=this;switch(e.type){case y:if(!x&&0!==e.button)return;o._start(e);break;case v:o._move(e);break;case I:case T:o._end(e);break;case E:o._resize();break;case"DOMMouseScroll":case"mousewheel":o._wheel(e);break;case _:o._transitionEnd(e)}},_checkDOMChanges:function(){this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale||this.refresh()},_scrollbar:function(e){var t,l=this;return l[e+"Scrollbar"]?(l[e+"ScrollbarWrapper"]||(t=o.createElement("div"),l.options.scrollbarClass?t.className=l.options.scrollbarClass+e.toUpperCase():t.style.cssText="position:absolute;z-index:100;"+("h"==e?"height:7px;bottom:1px;left:2px;right:"+(l.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(l.hScrollbar?"7":"2")+"px;top:2px;right:1px"),t.style.cssText+=";pointer-events:none;"+i+"transition-property:opacity;"+i+"transition-duration:"+(l.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(l.options.hideScrollbar?"0":"1"),l.wrapper.appendChild(t),l[e+"ScrollbarWrapper"]=t,t=o.createElement("div"),l.options.scrollbarClass||(t.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+i+"background-clip:padding-box;"+i+"box-sizing:border-box;"+("h"==e?"height:100%":"width:100%")+";"+i+"border-radius:3px;border-radius:3px"),t.style.cssText+=";pointer-events:none;"+i+"transition-property:"+i+"transform;"+i+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+i+"transition-duration:0;"+i+"transform: translate(0,0)"+X,l.options.useTransition&&(t.style.cssText+=";"+i+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),l[e+"ScrollbarWrapper"].appendChild(t),l[e+"ScrollbarIndicator"]=t),"h"==e?(l.hScrollbarSize=l.hScrollbarWrapper.clientWidth,l.hScrollbarIndicatorSize=n.max(n.round(l.hScrollbarSize*l.hScrollbarSize/l.scrollerW),8),l.hScrollbarIndicator.style.width=l.hScrollbarIndicatorSize+"px",l.hScrollbarMaxScroll=l.hScrollbarSize-l.hScrollbarIndicatorSize,l.hScrollbarProp=l.hScrollbarMaxScroll/l.maxScrollX):(l.vScrollbarSize=l.vScrollbarWrapper.clientHeight,l.vScrollbarIndicatorSize=n.max(n.round(l.vScrollbarSize*l.vScrollbarSize/l.scrollerH),8),l.vScrollbarIndicator.style.height=l.vScrollbarIndicatorSize+"px",l.vScrollbarMaxScroll=l.vScrollbarSize-l.vScrollbarIndicatorSize,l.vScrollbarProp=l.vScrollbarMaxScroll/l.maxScrollY),void l._scrollbarPos(e,!0)):void(l[e+"ScrollbarWrapper"]&&(g&&(l[e+"ScrollbarIndicator"].style[s]=""),l[e+"ScrollbarWrapper"].parentNode.removeChild(l[e+"ScrollbarWrapper"]),l[e+"ScrollbarWrapper"]=null,l[e+"ScrollbarIndicator"]=null))},_resize:function(){var e=this;setTimeout(function(){e.refresh()},h?200:0)},_pos:function(e,o){this.zoomed||(e=this.hScroll?e:0,o=this.vScroll?o:0,this.options.useTransform?this.scroller.style[s]="translate("+e+"px,"+o+"px) scale("+this.scale+")"+X:(e=n.round(e),o=n.round(o),this.scroller.style.left=e+"px",this.scroller.style.top=o+"px"),this.x=e,this.y=o,this._scrollbarPos("h"),this._scrollbarPos("v"))},_scrollbarPos:function(e,o){var t,l=this,r="h"==e?l.x:l.y;l[e+"Scrollbar"]&&(r=l[e+"ScrollbarProp"]*r,0>r?(l.options.fixedScrollbar||(t=l[e+"ScrollbarIndicatorSize"]+n.round(3*r),8>t&&(t=8),l[e+"ScrollbarIndicator"].style["h"==e?"width":"height"]=t+"px"),r=0):r>l[e+"ScrollbarMaxScroll"]&&(l.options.fixedScrollbar?r=l[e+"ScrollbarMaxScroll"]:(t=l[e+"ScrollbarIndicatorSize"]-n.round(3*(r-l[e+"ScrollbarMaxScroll"])),8>t&&(t=8),l[e+"ScrollbarIndicator"].style["h"==e?"width":"height"]=t+"px",r=l[e+"ScrollbarMaxScroll"]+(l[e+"ScrollbarIndicatorSize"]-t))),l[e+"ScrollbarWrapper"].style[d]="0",l[e+"ScrollbarWrapper"].style.opacity=o&&l.options.hideScrollbar?"0":"1",l[e+"ScrollbarIndicator"].style[s]="translate("+("h"==e?r+"px,0)":"0,"+r+"px)")+X)},_start:function(o){var t,l,r,i,a,c=this,p=x?o.touches[0]:o;c.enabled&&(c.options.onBeforeScrollStart&&c.options.onBeforeScrollStart.call(c,o),(c.options.useTransition||c.options.zoom)&&c._transitionTime(0),c.moved=!1,c.animating=!1,c.zoomed=!1,c.distX=0,c.distY=0,c.absDistX=0,c.absDistY=0,c.dirX=0,c.dirY=0,c.options.zoom&&x&&o.touches.length>1&&(i=n.abs(o.touches[0].pageX-o.touches[1].pageX),a=n.abs(o.touches[0].pageY-o.touches[1].pageY),c.touchesDistStart=n.sqrt(i*i+a*a),c.originX=n.abs(o.touches[0].pageX+o.touches[1].pageX-2*c.wrapperOffsetLeft)/2-c.x,c.originY=n.abs(o.touches[0].pageY+o.touches[1].pageY-2*c.wrapperOffsetTop)/2-c.y,c.options.onZoomStart&&c.options.onZoomStart.call(c,o)),c.options.momentum&&(c.options.useTransform?(t=getComputedStyle(c.scroller,null)[s].replace(/[^0-9\-.,]/g,"").split(","),l=+(t[12]||t[4]),r=+(t[13]||t[5])):(l=+getComputedStyle(c.scroller,null).left.replace(/[^0-9-]/g,""),r=+getComputedStyle(c.scroller,null).top.replace(/[^0-9-]/g,"")),(l!=c.x||r!=c.y)&&(c.options.useTransition?c._unbind(_):w(c.aniTime),c.steps=[],c._pos(l,r),c.options.onScrollEnd&&c.options.onScrollEnd.call(c))),c.absStartX=c.x,c.absStartY=c.y,c.startX=c.x,c.startY=c.y,c.pointX=p.pageX,c.pointY=p.pageY,c.startTime=o.timeStamp||Date.now(),c.options.onScrollStart&&c.options.onScrollStart.call(c,o),c._bind(v,e),c._bind(I,e),c._bind(T,e))},_move:function(e){var o,t,l,r=this,i=x?e.touches[0]:e,a=i.pageX-r.pointX,c=i.pageY-r.pointY,p=r.x+a,m=r.y+c,d=e.timeStamp||Date.now();return r.options.onBeforeScrollMove&&r.options.onBeforeScrollMove.call(r,e),r.options.zoom&&x&&e.touches.length>1?(o=n.abs(e.touches[0].pageX-e.touches[1].pageX),t=n.abs(e.touches[0].pageY-e.touches[1].pageY),r.touchesDist=n.sqrt(o*o+t*t),r.zoomed=!0,l=1/r.touchesDistStart*r.touchesDist*this.scale,l<r.options.zoomMin?l=.5*r.options.zoomMin*Math.pow(2,l/r.options.zoomMin):l>r.options.zoomMax&&(l=2*r.options.zoomMax*Math.pow(.5,r.options.zoomMax/l)),r.lastScale=l/this.scale,p=this.originX-this.originX*r.lastScale+this.x,m=this.originY-this.originY*r.lastScale+this.y,this.scroller.style[s]="translate("+p+"px,"+m+"px) scale("+l+")"+X,void(r.options.onZoom&&r.options.onZoom.call(r,e))):(r.pointX=i.pageX,r.pointY=i.pageY,(p>0||p<r.maxScrollX)&&(p=r.options.bounce?r.x+a/2:p>=0||r.maxScrollX>=0?0:r.maxScrollX),(m>r.minScrollY||m<r.maxScrollY)&&(m=r.options.bounce?r.y+c/2:m>=r.minScrollY||r.maxScrollY>=0?r.minScrollY:r.maxScrollY),r.distX+=a,r.distY+=c,r.absDistX=n.abs(r.distX),r.absDistY=n.abs(r.distY),void(r.absDistX<6&&r.absDistY<6||(r.options.lockDirection&&(r.absDistX>r.absDistY+5?(m=r.y,c=0):r.absDistY>r.absDistX+5&&(p=r.x,a=0)),r.moved=!0,r._pos(p,m),r.dirX=a>0?-1:0>a?1:0,r.dirY=c>0?-1:0>c?1:0,d-r.startTime>300&&(r.startTime=d,r.startX=r.x,r.startY=r.y),r.options.onScrollMove&&r.options.onScrollMove.call(r,e))))},_end:function(t){if(!x||0===t.touches.length){var l,r,i,a,p,m,d,h=this,u=x?t.changedTouches[0]:t,S={dist:0,time:0},b={dist:0,time:0},g=(t.timeStamp||Date.now())-h.startTime,f=h.x,E=h.y;if(h._unbind(v,e),h._unbind(I,e),h._unbind(T,e),h.options.onBeforeScrollEnd&&h.options.onBeforeScrollEnd.call(h,t),h.zoomed)return d=h.scale*h.lastScale,d=Math.max(h.options.zoomMin,d),d=Math.min(h.options.zoomMax,d),h.lastScale=d/h.scale,h.scale=d,h.x=h.originX-h.originX*h.lastScale+h.x,h.y=h.originY-h.originY*h.lastScale+h.y,h.scroller.style[c]="200ms",h.scroller.style[s]="translate("+h.x+"px,"+h.y+"px) scale("+h.scale+")"+X,h.zoomed=!1,h.refresh(),void(h.options.onZoomEnd&&h.options.onZoomEnd.call(h,t));if(!h.moved)return x&&(h.doubleTapTimer&&h.options.zoom?(clearTimeout(h.doubleTapTimer),h.doubleTapTimer=null,h.options.onZoomStart&&h.options.onZoomStart.call(h,t),h.zoom(h.pointX,h.pointY,1==h.scale?h.options.doubleTapZoom:1),h.options.onZoomEnd&&setTimeout(function(){h.options.onZoomEnd.call(h,t)},200)):this.options.handleClick&&(h.doubleTapTimer=setTimeout(function(){for(h.doubleTapTimer=null,l=u.target;1!=l.nodeType;)l=l.parentNode;"SELECT"!=l.tagName&&"INPUT"!=l.tagName&&"TEXTAREA"!=l.tagName&&(r=o.createEvent("MouseEvents"),r.initMouseEvent("click",!0,!0,t.view,1,u.screenX,u.screenY,u.clientX,u.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),r._fake=!0,l.dispatchEvent(r))},h.options.zoom?250:0))),h._resetPos(400),void(h.options.onTouchEnd&&h.options.onTouchEnd.call(h,t));if(300>g&&h.options.momentum&&(S=f?h._momentum(f-h.startX,g,-h.x,h.scrollerW-h.wrapperW+h.x,h.options.bounce?h.wrapperW:0):S,b=E?h._momentum(E-h.startY,g,-h.y,h.maxScrollY<0?h.scrollerH-h.wrapperH+h.y-h.minScrollY:0,h.options.bounce?h.wrapperH:0):b,f=h.x+S.dist,E=h.y+b.dist,(h.x>0&&f>0||h.x<h.maxScrollX&&f<h.maxScrollX)&&(S={dist:0,time:0}),(h.y>h.minScrollY&&E>h.minScrollY||h.y<h.maxScrollY&&E<h.maxScrollY)&&(b={dist:0,time:0})),S.dist||b.dist)return p=n.max(n.max(S.time,b.time),10),h.options.snap&&(i=f-h.absStartX,a=E-h.absStartY,n.abs(i)<h.options.snapThreshold&&n.abs(a)<h.options.snapThreshold?h.scrollTo(h.absStartX,h.absStartY,200):(m=h._snap(f,E),f=m.x,E=m.y,p=n.max(m.time,p))),h.scrollTo(n.round(f),n.round(E),p),void(h.options.onTouchEnd&&h.options.onTouchEnd.call(h,t));if(h.options.snap)return i=f-h.absStartX,a=E-h.absStartY,n.abs(i)<h.options.snapThreshold&&n.abs(a)<h.options.snapThreshold?h.scrollTo(h.absStartX,h.absStartY,200):(m=h._snap(h.x,h.y),(m.x!=h.x||m.y!=h.y)&&h.scrollTo(m.x,m.y,m.time)),void(h.options.onTouchEnd&&h.options.onTouchEnd.call(h,t));h._resetPos(200),h.options.onTouchEnd&&h.options.onTouchEnd.call(h,t)}},_resetPos:function(e){var o=this,t=o.x>=0?0:o.x<o.maxScrollX?o.maxScrollX:o.x,n=o.y>=o.minScrollY||o.maxScrollY>0?o.minScrollY:o.y<o.maxScrollY?o.maxScrollY:o.y;return t==o.x&&n==o.y?(o.moved&&(o.moved=!1,o.options.onScrollEnd&&o.options.onScrollEnd.call(o)),o.hScrollbar&&o.options.hideScrollbar&&("webkit"==r&&(o.hScrollbarWrapper.style[d]="300ms"),o.hScrollbarWrapper.style.opacity="0"),void(o.vScrollbar&&o.options.hideScrollbar&&("webkit"==r&&(o.vScrollbarWrapper.style[d]="300ms"),o.vScrollbarWrapper.style.opacity="0"))):void o.scrollTo(t,n,e||0)},_wheel:function(e){var o,t,n,l,r,i=this;if("wheelDeltaX"in e)o=e.wheelDeltaX/12,t=e.wheelDeltaY/12;else if("wheelDelta"in e)o=t=e.wheelDelta/12;else{if(!("detail"in e))return;o=t=3*-e.detail}return"zoom"==i.options.wheelAction?(r=i.scale*Math.pow(2,1/3*(t?t/Math.abs(t):0)),r<i.options.zoomMin&&(r=i.options.zoomMin),r>i.options.zoomMax&&(r=i.options.zoomMax),void(r!=i.scale&&(!i.wheelZoomCount&&i.options.onZoomStart&&i.options.onZoomStart.call(i,e),i.wheelZoomCount++,i.zoom(e.pageX,e.pageY,r,400),setTimeout(function(){i.wheelZoomCount--,!i.wheelZoomCount&&i.options.onZoomEnd&&i.options.onZoomEnd.call(i,e)},400)))):(n=i.x+o,l=i.y+t,n>0?n=0:n<i.maxScrollX&&(n=i.maxScrollX),l>i.minScrollY?l=i.minScrollY:l<i.maxScrollY&&(l=i.maxScrollY),void(i.maxScrollY<0&&i.scrollTo(n,l,0)))},_transitionEnd:function(e){var o=this;e.target==o.scroller&&(o._unbind(_),o._startAni())},_startAni:function(){var e,o,t,l=this,r=l.x,i=l.y,s=Date.now();if(!l.animating){if(!l.steps.length)return void l._resetPos(400);if(e=l.steps.shift(),e.x==r&&e.y==i&&(e.time=0),l.animating=!0,l.moved=!0,l.options.useTransition)return l._transitionTime(e.time),l._pos(e.x,e.y),l.animating=!1,void(e.time?l._bind(_):l._resetPos(0));t=function(){var a,c,p=Date.now();return p>=s+e.time?(l._pos(e.x,e.y),l.animating=!1,l.options.onAnimationEnd&&l.options.onAnimationEnd.call(l),void l._startAni()):(p=(p-s)/e.time-1,o=n.sqrt(1-p*p),a=(e.x-r)*o+r,c=(e.y-i)*o+i,l._pos(a,c),void(l.animating&&(l.aniTime=Y(t))))},t()}},_transitionTime:function(e){e+="ms",this.scroller.style[c]=e,this.hScrollbar&&(this.hScrollbarIndicator.style[c]=e),this.vScrollbar&&(this.vScrollbarIndicator.style[c]=e)},_momentum:function(e,o,t,l,r){var i=6e-4,s=n.abs(e)/o,a=s*s/(2*i),c=0,p=0;return e>0&&a>t?(p=r/(6/(a/s*i)),t+=p,s=s*t/a,a=t):0>e&&a>l&&(p=r/(6/(a/s*i)),l+=p,s=s*l/a,a=l),a*=0>e?-1:1,c=s/i,{dist:a,time:n.round(c)}},_offset:function(e){for(var o=-e.offsetLeft,t=-e.offsetTop;e=e.offsetParent;)o-=e.offsetLeft,t-=e.offsetTop;return e!=this.wrapper&&(o*=this.scale,t*=this.scale),{left:o,top:t}},_snap:function(e,o){var t,l,r,i,s,a,c=this;for(r=c.pagesX.length-1,t=0,l=c.pagesX.length;l>t;t++)if(e>=c.pagesX[t]){r=t;break}for(r==c.currPageX&&r>0&&c.dirX<0&&r--,e=c.pagesX[r],s=n.abs(e-c.pagesX[c.currPageX]),s=s?n.abs(c.x-e)/s*500:0,c.currPageX=r,r=c.pagesY.length-1,t=0;r>t;t++)if(o>=c.pagesY[t]){r=t;break}return r==c.currPageY&&r>0&&c.dirY<0&&r--,o=c.pagesY[r],a=n.abs(o-c.pagesY[c.currPageY]),a=a?n.abs(c.y-o)/a*500:0,c.currPageY=r,i=n.round(n.max(s,a))||200,{x:e,y:o,time:i}},_bind:function(e,o,t){(o||this.scroller).addEventListener(e,this,!!t)},_unbind:function(e,o,t){(o||this.scroller).removeEventListener(e,this,!!t)},destroy:function(){var o=this;o.scroller.style[s]="",o.hScrollbar=!1,o.vScrollbar=!1,o._scrollbar("h"),o._scrollbar("v"),o._unbind(E,e),o._unbind(y),o._unbind(v,e),o._unbind(I,e),o._unbind(T,e),o.options.hasTouch||(o._unbind("DOMMouseScroll"),o._unbind("mousewheel")),o.options.useTransition&&o._unbind(_),o.options.checkDOMChanges&&clearInterval(o.checkDOMTime),o.options.onDestroy&&o.options.onDestroy.call(o)},refresh:function(){var e,o,t,l,r=this,i=0,s=0;if(r.scale<r.options.zoomMin&&(r.scale=r.options.zoomMin),r.wrapperW=r.wrapper.clientWidth||1,r.wrapperH=r.wrapper.clientHeight||1,r.minScrollY=-r.options.topOffset||0,r.scrollerW=n.round(r.scroller.offsetWidth*r.scale),r.scrollerH=n.round((r.scroller.offsetHeight+r.minScrollY)*r.scale),r.maxScrollX=r.wrapperW-r.scrollerW,r.maxScrollY=r.wrapperH-r.scrollerH+r.minScrollY,r.dirX=0,r.dirY=0,r.options.onRefresh&&r.options.onRefresh.call(r),r.hScroll=r.options.hScroll&&r.maxScrollX<0,r.vScroll=r.options.vScroll&&(!r.options.bounceLock&&!r.hScroll||r.scrollerH>r.wrapperH),r.hScrollbar=r.hScroll&&r.options.hScrollbar,r.vScrollbar=r.vScroll&&r.options.vScrollbar&&r.scrollerH>r.wrapperH,e=r._offset(r.wrapper),r.wrapperOffsetLeft=-e.left,r.wrapperOffsetTop=-e.top,"string"==typeof r.options.snap)for(r.pagesX=[],r.pagesY=[],l=r.scroller.querySelectorAll(r.options.snap),o=0,t=l.length;t>o;o++)i=r._offset(l[o]),i.left+=r.wrapperOffsetLeft,i.top+=r.wrapperOffsetTop,r.pagesX[o]=i.left<r.maxScrollX?r.maxScrollX:i.left*r.scale,r.pagesY[o]=i.top<r.maxScrollY?r.maxScrollY:i.top*r.scale;else if(r.options.snap){for(r.pagesX=[];i>=r.maxScrollX;)r.pagesX[s]=i,i-=r.wrapperW,s++;for(r.maxScrollX%r.wrapperW&&(r.pagesX[r.pagesX.length]=r.maxScrollX-r.pagesX[r.pagesX.length-1]+r.pagesX[r.pagesX.length-1]),i=0,s=0,r.pagesY=[];i>=r.maxScrollY;)r.pagesY[s]=i,i-=r.wrapperH,s++;r.maxScrollY%r.wrapperH&&(r.pagesY[r.pagesY.length]=r.maxScrollY-r.pagesY[r.pagesY.length-1]+r.pagesY[r.pagesY.length-1])}r._scrollbar("h"),r._scrollbar("v"),r.zoomed||(r.scroller.style[c]="0",r._resetPos(400))},scrollTo:function(e,o,t,n){var l,r,i=this,s=e;for(i.stop(),s.length||(s=[{x:e,y:o,time:t,relative:n}]),l=0,r=s.length;r>l;l++)s[l].relative&&(s[l].x=i.x-s[l].x,s[l].y=i.y-s[l].y),i.steps.push({x:s[l].x,y:s[l].y,time:s[l].time||0});i._startAni()},scrollToElement:function(e,o){var t,l=this;e=e.nodeType?e:l.scroller.querySelector(e),e&&(t=l._offset(e),t.left+=l.wrapperOffsetLeft,t.top+=l.wrapperOffsetTop,t.left=t.left>0?0:t.left<l.maxScrollX?l.maxScrollX:t.left,t.top=t.top>l.minScrollY?l.minScrollY:t.top<l.maxScrollY?l.maxScrollY:t.top,o=void 0===o?n.max(2*n.abs(t.left),2*n.abs(t.top)):o,l.scrollTo(t.left,t.top,o))},scrollToPage:function(e,o,t){var n,l,r=this;t=void 0===t?400:t,r.options.onScrollStart&&r.options.onScrollStart.call(r),r.options.snap?(e="next"==e?r.currPageX+1:"prev"==e?r.currPageX-1:e,o="next"==o?r.currPageY+1:"prev"==o?r.currPageY-1:o,e=0>e?0:e>r.pagesX.length-1?r.pagesX.length-1:e,o=0>o?0:o>r.pagesY.length-1?r.pagesY.length-1:o,r.currPageX=e,r.currPageY=o,n=r.pagesX[e],l=r.pagesY[o]):(n=-r.wrapperW*e,l=-r.wrapperH*o,n<r.maxScrollX&&(n=r.maxScrollX),l<r.maxScrollY&&(l=r.maxScrollY)),r.scrollTo(n,l,t)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(v,e),this._unbind(I,e),this._unbind(T,e)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind(_):w(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(e,o,t,n){var l=this,r=t/l.scale;l.options.useTransform&&(l.zoomed=!0,n=void 0===n?200:n,e=e-l.wrapperOffsetLeft-l.x,o=o-l.wrapperOffsetTop-l.y,l.x=e-e*r+l.x,l.y=o-o*r+l.y,l.scale=t,l.refresh(),l.x=l.x>0?0:l.x<l.maxScrollX?l.maxScrollX:l.x,l.y=l.y>l.minScrollY?l.minScrollY:l.y<l.maxScrollY?l.maxScrollY:l.y,l.scroller.style[c]=n+"ms",l.scroller.style[s]="translate("+l.x+"px,"+l.y+"px) scale("+t+")"+X,l.zoomed=!1)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},l=null,"undefined"!=typeof exports?exports.iScroll=z:e.iScroll=z}(window,document);